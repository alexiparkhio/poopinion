function cov_1bkm46wm9j(){var path="C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\toggle-thumb-up.js";var hash="a3651ee6b402cf356c4dad1c2d6df79243e30df3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\toggle-thumb-up.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:47}},"1":{start:{line:2,column:38},end:{line:2,column:63}},"2":{start:{line:3,column:43},end:{line:3,column:70}},"3":{start:{line:17,column:0},end:{line:37,column:1}},"4":{start:{line:18,column:4},end:{line:18,column:29}},"5":{start:{line:19,column:4},end:{line:19,column:44}},"6":{start:{line:21,column:4},end:{line:36,column:24}},"7":{start:{line:23,column:12},end:{line:23,column:83}},"8":{start:{line:23,column:23},end:{line:23,column:83}},"9":{start:{line:24,column:12},end:{line:24,column:96}},"10":{start:{line:24,column:34},end:{line:24,column:96}},"11":{start:{line:25,column:12},end:{line:25,column:96}},"12":{start:{line:25,column:26},end:{line:25,column:96}},"13":{start:{line:27,column:12},end:{line:27,column:365}},"14":{start:{line:27,column:39},end:{line:27,column:365}},"15":{start:{line:29,column:12},end:{line:32,column:13}},"16":{start:{line:29,column:25},end:{line:29,column:26}},"17":{start:{line:30,column:26},end:{line:30,column:53}},"18":{start:{line:31,column:16},end:{line:31,column:266}},"19":{start:{line:31,column:39},end:{line:31,column:266}},"20":{start:{line:34,column:12},end:{line:34,column:338}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:17},end:{line:17,column:18}},loc:{start:{line:17,column:36},end:{line:37,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:14},end:{line:22,column:15}},loc:{start:{line:22,column:35},end:{line:35,column:9}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:355},end:{line:27,column:356}},loc:{start:{line:27,column:361},end:{line:27,column:364}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:31,column:256},end:{line:31,column:257}},loc:{start:{line:31,column:262},end:{line:31,column:265}},line:31},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:328},end:{line:34,column:329}},loc:{start:{line:34,column:334},end:{line:34,column:337}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:36,column:14},end:{line:36,column:15}},loc:{start:{line:36,column:20},end:{line:36,column:23}},line:36}},branchMap:{"0":{loc:{start:{line:23,column:12},end:{line:23,column:83}},type:"if",locations:[{start:{line:23,column:12},end:{line:23,column:83}},{start:{line:23,column:12},end:{line:23,column:83}}],line:23},"1":{loc:{start:{line:24,column:12},end:{line:24,column:96}},type:"if",locations:[{start:{line:24,column:12},end:{line:24,column:96}},{start:{line:24,column:12},end:{line:24,column:96}}],line:24},"2":{loc:{start:{line:25,column:12},end:{line:25,column:96}},type:"if",locations:[{start:{line:25,column:12},end:{line:25,column:96}},{start:{line:25,column:12},end:{line:25,column:96}}],line:25},"3":{loc:{start:{line:27,column:12},end:{line:27,column:365}},type:"if",locations:[{start:{line:27,column:12},end:{line:27,column:365}},{start:{line:27,column:12},end:{line:27,column:365}}],line:27},"4":{loc:{start:{line:31,column:16},end:{line:31,column:266}},type:"if",locations:[{start:{line:31,column:16},end:{line:31,column:266}},{start:{line:31,column:16},end:{line:31,column:266}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"a3651ee6b402cf356c4dad1c2d6df79243e30df3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1bkm46wm9j=function(){return actualCoverage;};return actualCoverage;}cov_1bkm46wm9j();const{validate}=(cov_1bkm46wm9j().s[0]++,require('poopinion-utils'));const{models:{User,Comment}}=(cov_1bkm46wm9j().s[1]++,require('poopinion-data'));const{NotAllowedError,NotFoundError}=(cov_1bkm46wm9j().s[2]++,require('poopinion-errors'));/**
 * Adds or removes a thumb-up functionality to a target comment
 * 
 * @param {string} id user's unique id
 * @param {string} commentId comment's unique id
 * 
 * @returns {Promise<string>} returns an empty Promise
 * 
 * @throws {NotAllowedError} if the user exists but has the property 'deactivated' as true
 * @throws {NotFoundError} if the user or the comment do not exist
 */cov_1bkm46wm9j().s[3]++;module.exports=(id,commentId)=>{cov_1bkm46wm9j().f[0]++;cov_1bkm46wm9j().s[4]++;validate.string(id,'id');cov_1bkm46wm9j().s[5]++;validate.string(commentId,'comment ID');cov_1bkm46wm9j().s[6]++;return Promise.all([User.findById(id).lean(),Comment.findById(commentId).lean()]).then(([user,comment])=>{cov_1bkm46wm9j().f[1]++;cov_1bkm46wm9j().s[7]++;if(!user){cov_1bkm46wm9j().b[0][0]++;cov_1bkm46wm9j().s[8]++;throw new NotFoundError(`user with id ${id} does not exist`);}else{cov_1bkm46wm9j().b[0][1]++;}cov_1bkm46wm9j().s[9]++;if(user.deactivated){cov_1bkm46wm9j().b[1][0]++;cov_1bkm46wm9j().s[10]++;throw new NotAllowedError(`user with id ${id} is deactivated`);}else{cov_1bkm46wm9j().b[1][1]++;}cov_1bkm46wm9j().s[11]++;if(!comment){cov_1bkm46wm9j().b[2][0]++;cov_1bkm46wm9j().s[12]++;throw new NotFoundError(`comment with id ${commentId} does not exist`);}else{cov_1bkm46wm9j().b[2][1]++;}cov_1bkm46wm9j().s[13]++;if(!user.thumbsUp.length){cov_1bkm46wm9j().b[3][0]++;cov_1bkm46wm9j().s[14]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$addToSet:{thumbsUp:comment._id.toString()},$pull:{thumbsDown:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$addToSet:{thumbsUp:user._id.toString()},$pull:{thumbsDown:user._id.toString()}})]).then(()=>{cov_1bkm46wm9j().f[2]++;});}else{cov_1bkm46wm9j().b[3][1]++;}cov_1bkm46wm9j().s[15]++;for(let i=(cov_1bkm46wm9j().s[16]++,0);i<user.thumbsUp.length;i++){let tUp=(cov_1bkm46wm9j().s[17]++,user.thumbsUp[i].toString());cov_1bkm46wm9j().s[18]++;if(tUp===commentId){cov_1bkm46wm9j().b[4][0]++;cov_1bkm46wm9j().s[19]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$pull:{thumbsUp:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$pull:{thumbsUp:user._id.toString()}})]).then(()=>{cov_1bkm46wm9j().f[3]++;});}else{cov_1bkm46wm9j().b[4][1]++;}}cov_1bkm46wm9j().s[20]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$addToSet:{thumbsUp:comment._id.toString()},$pull:{thumbsDown:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$addToSet:{thumbsUp:user._id.toString()},$pull:{thumbsDown:user._id.toString()}})]).then(()=>{cov_1bkm46wm9j().f[4]++;});}).then(()=>{cov_1bkm46wm9j().f[5]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvZ2dsZS10aHVtYi11cC5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsInJlcXVpcmUiLCJtb2RlbHMiLCJVc2VyIiwiQ29tbWVudCIsIk5vdEFsbG93ZWRFcnJvciIsIk5vdEZvdW5kRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIiwiaWQiLCJjb21tZW50SWQiLCJzdHJpbmciLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJsZWFuIiwidGhlbiIsInVzZXIiLCJjb21tZW50IiwiZGVhY3RpdmF0ZWQiLCJ0aHVtYnNVcCIsImxlbmd0aCIsImZpbmRCeUlkQW5kVXBkYXRlIiwiX2lkIiwidG9TdHJpbmciLCIkYWRkVG9TZXQiLCIkcHVsbCIsInRodW1ic0Rvd24iLCJpIiwidFVwIl0sIm1hcHBpbmdzIjoiMmhJQUFBLEtBQU0sQ0FBRUEsUUFBRiwyQkFBZUMsT0FBTyxDQUFDLGlCQUFELENBQXRCLENBQU4sQ0FDQSxLQUFNLENBQUVDLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQVFDLE9BQVIsQ0FBViwyQkFBZ0NILE9BQU8sQ0FBQyxnQkFBRCxDQUF2QyxDQUFOLENBQ0EsS0FBTSxDQUFFSSxlQUFGLENBQW1CQyxhQUFuQiwyQkFBcUNMLE9BQU8sQ0FBQyxrQkFBRCxDQUE1QyxDQUFOLENBRUE7Ozs7Ozs7Ozs7MkJBWUFNLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxFQUFELENBQUtDLFNBQUwsR0FBbUIsaURBQ2hDVixRQUFRLENBQUNXLE1BQVQsQ0FBZ0JGLEVBQWhCLENBQW9CLElBQXBCLEVBRGdDLHdCQUVoQ1QsUUFBUSxDQUFDVyxNQUFULENBQWdCRCxTQUFoQixDQUEyQixZQUEzQixFQUZnQyx3QkFJaEMsTUFBT0UsQ0FBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksQ0FBQ1YsSUFBSSxDQUFDVyxRQUFMLENBQWNMLEVBQWQsRUFBa0JNLElBQWxCLEVBQUQsQ0FBMkJYLE9BQU8sQ0FBQ1UsUUFBUixDQUFpQkosU0FBakIsRUFBNEJLLElBQTVC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Q0FBbURFLEtBQUssQ0FBRSxDQUFFQyxVQUFVLENBQUVULE9BQU8sQ0FBQ0ssR0FBUixDQUFZQyxRQUFaLEVBQWQsQ0FBMUQsQ0FBNUMsQ0FBRCxDQUFrSnBCLE9BQU8sQ0FBQ2tCLGlCQUFSLENBQTBCSixPQUFPLENBQUNLLEdBQVIsQ0FBWUMsUUFBWixFQUExQixDQUFrRCxDQUFFQyxTQUFTLENBQUUsQ0FBRUwsUUFBUSxDQUFFSCxJQUFJLENBQUNNLEdBQUwsQ0FBU0MsUUFBVCxFQUFaLENBQWIsQ0FBZ0RFLEtBQUssQ0FBRSxDQUFFQyxVQUFVLENBQUVWLElBQUksQ0FBQ00sR0FBTCxDQUFTQyxRQUFULEVBQWQsQ0FBdkQsQ0FBbEQsQ0FBbEosQ0FBWixFQUFnVFIsSUFBaFQsQ0FBcVQsSUFBTSx5QkFBRyxDQUE5VCxDQUFQLENBQ0gsQ0FkRSxFQWVGQSxJQWZFLENBZUcsSUFBTSx5QkFBRyxDQWZaLENBQVAsQ0FnQkgsQ0FwQkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdwb29waW5pb24tdXRpbHMnKVxyXG5jb25zdCB7IG1vZGVsczogeyBVc2VyLCBDb21tZW50IH0gfSA9IHJlcXVpcmUoJ3Bvb3Bpbmlvbi1kYXRhJylcclxuY29uc3QgeyBOb3RBbGxvd2VkRXJyb3IsIE5vdEZvdW5kRXJyb3IgfSA9IHJlcXVpcmUoJ3Bvb3Bpbmlvbi1lcnJvcnMnKVxyXG5cclxuLyoqXHJcbiAqIEFkZHMgb3IgcmVtb3ZlcyBhIHRodW1iLXVwIGZ1bmN0aW9uYWxpdHkgdG8gYSB0YXJnZXQgY29tbWVudFxyXG4gKiBcclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIHVzZXIncyB1bmlxdWUgaWRcclxuICogQHBhcmFtIHtzdHJpbmd9IGNvbW1lbnRJZCBjb21tZW50J3MgdW5pcXVlIGlkXHJcbiAqIFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSByZXR1cm5zIGFuIGVtcHR5IFByb21pc2VcclxuICogXHJcbiAqIEB0aHJvd3Mge05vdEFsbG93ZWRFcnJvcn0gaWYgdGhlIHVzZXIgZXhpc3RzIGJ1dCBoYXMgdGhlIHByb3BlcnR5ICdkZWFjdGl2YXRlZCcgYXMgdHJ1ZVxyXG4gKiBAdGhyb3dzIHtOb3RGb3VuZEVycm9yfSBpZiB0aGUgdXNlciBvciB0aGUgY29tbWVudCBkbyBub3QgZXhpc3RcclxuICovXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IChpZCwgY29tbWVudElkKSA9PiB7XHJcbiAgICB2YWxpZGF0ZS5zdHJpbmcoaWQsICdpZCcpXHJcbiAgICB2YWxpZGF0ZS5zdHJpbmcoY29tbWVudElkLCAnY29tbWVudCBJRCcpXHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtVc2VyLmZpbmRCeUlkKGlkKS5sZWFuKCksIENvbW1lbnQuZmluZEJ5SWQoY29tbWVudElkKS5sZWFuKCldKVxyXG4gICAgICAgIC50aGVuKChbdXNlciwgY29tbWVudF0pID0+IHtcclxuICAgICAgICAgICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgdXNlciB3aXRoIGlkICR7aWR9IGRvZXMgbm90IGV4aXN0YClcclxuICAgICAgICAgICAgaWYgKHVzZXIuZGVhY3RpdmF0ZWQpIHRocm93IG5ldyBOb3RBbGxvd2VkRXJyb3IoYHVzZXIgd2l0aCBpZCAke2lkfSBpcyBkZWFjdGl2YXRlZGApXHJcbiAgICAgICAgICAgIGlmICghY29tbWVudCkgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYGNvbW1lbnQgd2l0aCBpZCAke2NvbW1lbnRJZH0gZG9lcyBub3QgZXhpc3RgKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKCF1c2VyLnRodW1ic1VwLmxlbmd0aCkgcmV0dXJuIFByb21pc2UuYWxsKFtVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHVzZXIuX2lkLnRvU3RyaW5nKCksIHsgJGFkZFRvU2V0OiB7IHRodW1ic1VwOiBjb21tZW50Ll9pZC50b1N0cmluZygpIH0sICRwdWxsOiB7IHRodW1ic0Rvd246IGNvbW1lbnQuX2lkLnRvU3RyaW5nKCkgfSB9KSwgQ29tbWVudC5maW5kQnlJZEFuZFVwZGF0ZShjb21tZW50Ll9pZC50b1N0cmluZygpLCB7ICRhZGRUb1NldDogeyB0aHVtYnNVcDogdXNlci5faWQudG9TdHJpbmcoKSB9LCAkcHVsbDogeyB0aHVtYnNEb3duOiB1c2VyLl9pZC50b1N0cmluZygpIH0gfSldKS50aGVuKCgpID0+IHsgfSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXNlci50aHVtYnNVcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRVcCA9IHVzZXIudGh1bWJzVXBbaV0udG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgaWYgKHRVcCA9PT0gY29tbWVudElkKSByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWRBbmRVcGRhdGUodXNlci5faWQudG9TdHJpbmcoKSwgeyAkcHVsbDogeyB0aHVtYnNVcDogY29tbWVudC5faWQudG9TdHJpbmcoKSB9IH0pLCBDb21tZW50LmZpbmRCeUlkQW5kVXBkYXRlKGNvbW1lbnQuX2lkLnRvU3RyaW5nKCksIHsgJHB1bGw6IHsgdGh1bWJzVXA6IHVzZXIuX2lkLnRvU3RyaW5nKCkgfSB9KV0pLnRoZW4oKCkgPT4geyB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWRBbmRVcGRhdGUodXNlci5faWQudG9TdHJpbmcoKSwgeyAkYWRkVG9TZXQ6IHsgdGh1bWJzVXA6IGNvbW1lbnQuX2lkLnRvU3RyaW5nKCkgfSwgJHB1bGw6IHsgdGh1bWJzRG93bjogY29tbWVudC5faWQudG9TdHJpbmcoKSB9IH0pLCBDb21tZW50LmZpbmRCeUlkQW5kVXBkYXRlKGNvbW1lbnQuX2lkLnRvU3RyaW5nKCksIHsgJGFkZFRvU2V0OiB7IHRodW1ic1VwOiB1c2VyLl9pZC50b1N0cmluZygpIH0sICRwdWxsOiB7IHRodW1ic0Rvd246IHVzZXIuX2lkLnRvU3RyaW5nKCkgfSB9KV0pLnRoZW4oKCkgPT4geyB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4geyB9KVxyXG59Il19