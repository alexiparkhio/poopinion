function cov_12rvqvjd85(){var path="C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\retrieve-toilet.js";var hash="cd421d1c82bde09e9ed29ee5845da74efce87ef7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\retrieve-toilet.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:47}},"1":{start:{line:2,column:31},end:{line:2,column:56}},"2":{start:{line:3,column:26},end:{line:3,column:53}},"3":{start:{line:14,column:0},end:{line:41,column:1}},"4":{start:{line:15,column:4},end:{line:15,column:42}},"5":{start:{line:17,column:4},end:{line:40,column:10}},"6":{start:{line:19,column:12},end:{line:19,column:93}},"7":{start:{line:19,column:25},end:{line:19,column:93}},"8":{start:{line:20,column:12},end:{line:20,column:45}},"9":{start:{line:21,column:12},end:{line:21,column:29}},"10":{start:{line:22,column:12},end:{line:22,column:29}},"11":{start:{line:24,column:12},end:{line:24,column:65}},"12":{start:{line:25,column:12},end:{line:25,column:39}},"13":{start:{line:27,column:12},end:{line:27,column:28}},"14":{start:{line:29,column:12},end:{line:35,column:14}},"15":{start:{line:30,column:16},end:{line:30,column:51}},"16":{start:{line:31,column:16},end:{line:31,column:34}},"17":{start:{line:32,column:16},end:{line:32,column:34}},"18":{start:{line:34,column:16},end:{line:34,column:134}},"19":{start:{line:37,column:12},end:{line:37,column:89}},"20":{start:{line:39,column:12},end:{line:39,column:25}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:14,column:17},end:{line:14,column:18}},loc:{start:{line:14,column:29},end:{line:41,column:1}},line:14},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:14},end:{line:18,column:15}},loc:{start:{line:18,column:24},end:{line:40,column:9}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:29,column:66},end:{line:29,column:67}},loc:{start:{line:29,column:77},end:{line:35,column:13}},line:29}},branchMap:{"0":{loc:{start:{line:19,column:12},end:{line:19,column:93}},type:"if",locations:[{start:{line:19,column:12},end:{line:19,column:93}},{start:{line:19,column:12},end:{line:19,column:93}}],line:19},"1":{loc:{start:{line:29,column:12},end:{line:35,column:14}},type:"binary-expr",locations:[{start:{line:29,column:12},end:{line:29,column:38}},{start:{line:29,column:42},end:{line:35,column:14}}],line:29}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cd421d1c82bde09e9ed29ee5845da74efce87ef7"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_12rvqvjd85=function(){return actualCoverage;};return actualCoverage;}cov_12rvqvjd85();const{validate}=(cov_12rvqvjd85().s[0]++,require('poopinion-utils'));const{models:{Toilet}}=(cov_12rvqvjd85().s[1]++,require('poopinion-data'));const{NotFoundError}=(cov_12rvqvjd85().s[2]++,require('poopinion-errors'));/**
 * Retrieves all toilet posts that matches the specified query criteria
 * 
 * @param {string} toiletId toilet's unique id
 * 
 * @returns {Object} returns an object with all the specific info of the toilet
 * @throws {NotFoundError} if the user does not exist
 */cov_12rvqvjd85().s[3]++;module.exports=toiletId=>{cov_12rvqvjd85().f[0]++;cov_12rvqvjd85().s[4]++;validate.string(toiletId,'toilet ID');cov_12rvqvjd85().s[5]++;return Toilet.findById(toiletId).populate('publisher','name surname email age gender').populate('comments').populate({path:'comments',populate:{path:'publisher'}}).lean().then(toilet=>{cov_12rvqvjd85().f[1]++;cov_12rvqvjd85().s[6]++;if(!toilet){cov_12rvqvjd85().b[0][0]++;cov_12rvqvjd85().s[7]++;throw new NotFoundError(`toilet with id ${toiletId} does not exist`);}else{cov_12rvqvjd85().b[0][1]++;}cov_12rvqvjd85().s[8]++;toilet.id=toilet._id.toString();cov_12rvqvjd85().s[9]++;delete toilet._id;cov_12rvqvjd85().s[10]++;delete toilet.__v;cov_12rvqvjd85().s[11]++;toilet.publisher.id=toilet.publisher._id.toString();cov_12rvqvjd85().s[12]++;delete toilet.publisher._id;cov_12rvqvjd85().s[13]++;toilet.score=0;cov_12rvqvjd85().s[14]++;(cov_12rvqvjd85().b[1][0]++,toilet.comments.length>0)&&(cov_12rvqvjd85().b[1][1]++,toilet.comments.forEach(comment=>{cov_12rvqvjd85().f[2]++;cov_12rvqvjd85().s[15]++;comment.id=comment._id.toString();cov_12rvqvjd85().s[16]++;delete comment._id;cov_12rvqvjd85().s[17]++;delete comment.__v;cov_12rvqvjd85().s[18]++;toilet.score+=(comment.rating.overallRating+comment.rating.cleanness*0.5+comment.rating.looks*0.5)/2;}));cov_12rvqvjd85().s[19]++;toilet.score=parseFloat((toilet.score/toilet.comments.length).toFixed(2));cov_12rvqvjd85().s[20]++;return toilet;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLXRvaWxldC5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsInJlcXVpcmUiLCJtb2RlbHMiLCJUb2lsZXQiLCJOb3RGb3VuZEVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyIsInRvaWxldElkIiwic3RyaW5nIiwiZmluZEJ5SWQiLCJwb3B1bGF0ZSIsInBhdGgiLCJsZWFuIiwidGhlbiIsInRvaWxldCIsImlkIiwiX2lkIiwidG9TdHJpbmciLCJfX3YiLCJwdWJsaXNoZXIiLCJzY29yZSIsImNvbW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsImNvbW1lbnQiLCJyYXRpbmciLCJvdmVyYWxsUmF0aW5nIiwiY2xlYW5uZXNzIiwibG9va3MiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCJdLCJtYXBwaW5ncyI6InU5RkFBQSxLQUFNLENBQUVBLFFBQUYsMkJBQWVDLE9BQU8sQ0FBQyxpQkFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsTUFBRixDQUFWLDJCQUF5QkYsT0FBTyxDQUFDLGdCQUFELENBQWhDLENBQU4sQ0FDQSxLQUFNLENBQUVHLGFBQUYsMkJBQW9CSCxPQUFPLENBQUMsa0JBQUQsQ0FBM0IsQ0FBTixDQUVBOzs7Ozs7OzJCQVNBSSxNQUFNLENBQUNDLE9BQVAsQ0FBaUJDLFFBQVEsRUFBSSxpREFDekJQLFFBQVEsQ0FBQ1EsTUFBVCxDQUFnQkQsUUFBaEIsQ0FBMEIsV0FBMUIsRUFEeUIsd0JBR3pCLE1BQU9KLENBQUFBLE1BQU0sQ0FBQ00sUUFBUCxDQUFnQkYsUUFBaEIsRUFBMEJHLFFBQTFCLENBQW1DLFdBQW5DLENBQWdELCtCQUFoRCxFQUFpRkEsUUFBakYsQ0FBMEYsVUFBMUYsRUFBc0dBLFFBQXRHLENBQStHLENBQUVDLElBQUksQ0FBRSxVQUFSLENBQW9CRCxRQUFRLENBQUUsQ0FBRUMsSUFBSSxDQUFFLFdBQVIsQ0FBOUIsQ0FBL0csRUFBc0tDLElBQXRLLEdBQ0ZDLElBREUsQ0FDR0MsTUFBTSxFQUFJLGlEQUNaLEdBQUksQ0FBQ0EsTUFBTCxDQUFhLHlEQUFNLElBQUlWLENBQUFBLGFBQUosQ0FBbUIsa0JBQWlCRyxRQUFTLGlCQUE3QyxDQUFOLENBQW9FLENBQWpGLGlDQURZLHdCQUVaTyxNQUFNLENBQUNDLEVBQVAsQ0FBWUQsTUFBTSxDQUFDRSxHQUFQLENBQVdDLFFBQVgsRUFBWixDQUZZLHdCQUdaLE1BQU9ILENBQUFBLE1BQU0sQ0FBQ0UsR0FBZCxDQUhZLHlCQUlaLE1BQU9GLENBQUFBLE1BQU0sQ0FBQ0ksR0FBZCxDQUpZLHlCQU1aSixNQUFNLENBQUNLLFNBQVAsQ0FBaUJKLEVBQWpCLENBQXNCRCxNQUFNLENBQUNLLFNBQVAsQ0FBaUJILEdBQWpCLENBQXFCQyxRQUFyQixFQUF0QixDQU5ZLHlCQU9aLE1BQU9ILENBQUFBLE1BQU0sQ0FBQ0ssU0FBUCxDQUFpQkgsR0FBeEIsQ0FQWSx5QkFTWkYsTUFBTSxDQUFDTSxLQUFQLENBQWUsQ0FBZixDQVRZLHlCQVdaLDRCQUFBTixNQUFNLENBQUNPLFFBQVAsQ0FBZ0JDLE1BQWhCLENBQXlCLENBQXpCLCtCQUE4QlIsTUFBTSxDQUFDTyxRQUFQLENBQWdCRSxPQUFoQixDQUF3QkMsT0FBTyxFQUFJLGtEQUM3REEsT0FBTyxDQUFDVCxFQUFSLENBQWFTLE9BQU8sQ0FBQ1IsR0FBUixDQUFZQyxRQUFaLEVBQWIsQ0FENkQseUJBRTdELE1BQU9PLENBQUFBLE9BQU8sQ0FBQ1IsR0FBZixDQUY2RCx5QkFHN0QsTUFBT1EsQ0FBQUEsT0FBTyxDQUFDTixHQUFmLENBSDZELHlCQUs3REosTUFBTSxDQUFDTSxLQUFQLEVBQWlCLENBQUNJLE9BQU8sQ0FBQ0MsTUFBUixDQUFlQyxhQUFmLENBQWdDRixPQUFPLENBQUNDLE1BQVIsQ0FBZUUsU0FBZixDQUEyQixHQUEzRCxDQUFtRUgsT0FBTyxDQUFDQyxNQUFSLENBQWVHLEtBQWYsQ0FBdUIsR0FBM0YsRUFBbUcsQ0FBcEgsQ0FDSCxDQU42QixDQUE5QixFQVhZLHlCQW1CWmQsTUFBTSxDQUFDTSxLQUFQLENBQWVTLFVBQVUsQ0FBQyxDQUFDZixNQUFNLENBQUNNLEtBQVAsQ0FBZU4sTUFBTSxDQUFDTyxRQUFQLENBQWdCQyxNQUFoQyxFQUF3Q1EsT0FBeEMsQ0FBZ0QsQ0FBaEQsQ0FBRCxDQUF6QixDQW5CWSx5QkFxQlosTUFBT2hCLENBQUFBLE1BQVAsQ0FDSCxDQXZCRSxDQUFQLENBd0JILENBM0JEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyB2YWxpZGF0ZSB9ID0gcmVxdWlyZSgncG9vcGluaW9uLXV0aWxzJylcclxuY29uc3QgeyBtb2RlbHM6IHsgVG9pbGV0IH0gfSA9IHJlcXVpcmUoJ3Bvb3Bpbmlvbi1kYXRhJylcclxuY29uc3QgeyBOb3RGb3VuZEVycm9yIH0gPSByZXF1aXJlKCdwb29waW5pb24tZXJyb3JzJylcclxuXHJcbi8qKlxyXG4gKiBSZXRyaWV2ZXMgYWxsIHRvaWxldCBwb3N0cyB0aGF0IG1hdGNoZXMgdGhlIHNwZWNpZmllZCBxdWVyeSBjcml0ZXJpYVxyXG4gKiBcclxuICogQHBhcmFtIHtzdHJpbmd9IHRvaWxldElkIHRvaWxldCdzIHVuaXF1ZSBpZFxyXG4gKiBcclxuICogQHJldHVybnMge09iamVjdH0gcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHNwZWNpZmljIGluZm8gb2YgdGhlIHRvaWxldFxyXG4gKiBAdGhyb3dzIHtOb3RGb3VuZEVycm9yfSBpZiB0aGUgdXNlciBkb2VzIG5vdCBleGlzdFxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gdG9pbGV0SWQgPT4ge1xyXG4gICAgdmFsaWRhdGUuc3RyaW5nKHRvaWxldElkLCAndG9pbGV0IElEJylcclxuXHJcbiAgICByZXR1cm4gVG9pbGV0LmZpbmRCeUlkKHRvaWxldElkKS5wb3B1bGF0ZSgncHVibGlzaGVyJywgJ25hbWUgc3VybmFtZSBlbWFpbCBhZ2UgZ2VuZGVyJykucG9wdWxhdGUoJ2NvbW1lbnRzJykucG9wdWxhdGUoeyBwYXRoOiAnY29tbWVudHMnLCBwb3B1bGF0ZTogeyBwYXRoOiAncHVibGlzaGVyJyB9IH0pLmxlYW4oKVxyXG4gICAgICAgIC50aGVuKHRvaWxldCA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdG9pbGV0KSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgdG9pbGV0IHdpdGggaWQgJHt0b2lsZXRJZH0gZG9lcyBub3QgZXhpc3RgKVxyXG4gICAgICAgICAgICB0b2lsZXQuaWQgPSB0b2lsZXQuX2lkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgZGVsZXRlIHRvaWxldC5faWRcclxuICAgICAgICAgICAgZGVsZXRlIHRvaWxldC5fX3ZcclxuXHJcbiAgICAgICAgICAgIHRvaWxldC5wdWJsaXNoZXIuaWQgPSB0b2lsZXQucHVibGlzaGVyLl9pZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgIGRlbGV0ZSB0b2lsZXQucHVibGlzaGVyLl9pZFxyXG5cclxuICAgICAgICAgICAgdG9pbGV0LnNjb3JlID0gMFxyXG5cclxuICAgICAgICAgICAgdG9pbGV0LmNvbW1lbnRzLmxlbmd0aCA+IDAgJiYgdG9pbGV0LmNvbW1lbnRzLmZvckVhY2goY29tbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb21tZW50LmlkID0gY29tbWVudC5faWQudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIGNvbW1lbnQuX2lkXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5fX3ZcclxuXHJcbiAgICAgICAgICAgICAgICB0b2lsZXQuc2NvcmUgKz0gKChjb21tZW50LnJhdGluZy5vdmVyYWxsUmF0aW5nICsgKGNvbW1lbnQucmF0aW5nLmNsZWFubmVzcyAqIDAuNSkgKyAoY29tbWVudC5yYXRpbmcubG9va3MgKiAwLjUpKSAvIDIpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB0b2lsZXQuc2NvcmUgPSBwYXJzZUZsb2F0KCh0b2lsZXQuc2NvcmUgLyB0b2lsZXQuY29tbWVudHMubGVuZ3RoKS50b0ZpeGVkKDIpKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRvaWxldFxyXG4gICAgICAgIH0pXHJcbn0iXX0=