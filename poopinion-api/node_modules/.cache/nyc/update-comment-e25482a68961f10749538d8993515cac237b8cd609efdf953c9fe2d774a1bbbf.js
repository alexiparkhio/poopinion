function cov_1d182xqkg0(){var path="C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\update-comment.js";var hash="5f70e28a4423236d9b87e93d889966cd5dc11b4e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\update-comment.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:47}},"1":{start:{line:2,column:38},end:{line:2,column:63}},"2":{start:{line:3,column:43},end:{line:3,column:70}},"3":{start:{line:18,column:0},end:{line:32,column:1}},"4":{start:{line:19,column:4},end:{line:19,column:29}},"5":{start:{line:20,column:4},end:{line:20,column:44}},"6":{start:{line:21,column:4},end:{line:21,column:39}},"7":{start:{line:23,column:4},end:{line:31,column:24}},"8":{start:{line:25,column:12},end:{line:25,column:83}},"9":{start:{line:25,column:23},end:{line:25,column:83}},"10":{start:{line:26,column:12},end:{line:26,column:96}},"11":{start:{line:26,column:34},end:{line:26,column:96}},"12":{start:{line:27,column:12},end:{line:27,column:96}},"13":{start:{line:27,column:26},end:{line:27,column:96}},"14":{start:{line:29,column:12},end:{line:29,column:71}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:17},end:{line:18,column:18}},loc:{start:{line:18,column:42},end:{line:32,column:1}},line:18},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:14},end:{line:24,column:15}},loc:{start:{line:24,column:35},end:{line:30,column:9}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:14},end:{line:31,column:15}},loc:{start:{line:31,column:20},end:{line:31,column:23}},line:31}},branchMap:{"0":{loc:{start:{line:25,column:12},end:{line:25,column:83}},type:"if",locations:[{start:{line:25,column:12},end:{line:25,column:83}},{start:{line:25,column:12},end:{line:25,column:83}}],line:25},"1":{loc:{start:{line:26,column:12},end:{line:26,column:96}},type:"if",locations:[{start:{line:26,column:12},end:{line:26,column:96}},{start:{line:26,column:12},end:{line:26,column:96}}],line:26},"2":{loc:{start:{line:27,column:12},end:{line:27,column:96}},type:"if",locations:[{start:{line:27,column:12},end:{line:27,column:96}},{start:{line:27,column:12},end:{line:27,column:96}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5f70e28a4423236d9b87e93d889966cd5dc11b4e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1d182xqkg0=function(){return actualCoverage;};return actualCoverage;}cov_1d182xqkg0();const{validate}=(cov_1d182xqkg0().s[0]++,require('poopinion-utils'));const{models:{User,Comment}}=(cov_1d182xqkg0().s[1]++,require('poopinion-data'));const{NotAllowedError,NotFoundError}=(cov_1d182xqkg0().s[2]++,require('poopinion-errors'));/**
 * Updates the user's comment data
 * 
 * @param {string} id user's unique ID
 * @param {string} commentId comment's unique id
 * @param {object} data the elements that will be updated
 * 
 * @returns {Promise<string>} an empty Promise on a successful update
 * 
 * @throws {NotAllowedError} if a user set a wrong password or is deactivated
 * @throws {NotFoundError} if the user or the comment do not exist
 */cov_1d182xqkg0().s[3]++;module.exports=(id,commentId,data)=>{cov_1d182xqkg0().f[0]++;cov_1d182xqkg0().s[4]++;validate.string(id,'id');cov_1d182xqkg0().s[5]++;validate.string(commentId,'comment ID');cov_1d182xqkg0().s[6]++;validate.type(data,'data',Object);cov_1d182xqkg0().s[7]++;return Promise.all([User.findById(id),Comment.findById(commentId)]).then(([user,comment])=>{cov_1d182xqkg0().f[1]++;cov_1d182xqkg0().s[8]++;if(!user){cov_1d182xqkg0().b[0][0]++;cov_1d182xqkg0().s[9]++;throw new NotFoundError(`user with id ${id} does not exist`);}else{cov_1d182xqkg0().b[0][1]++;}cov_1d182xqkg0().s[10]++;if(user.deactivated){cov_1d182xqkg0().b[1][0]++;cov_1d182xqkg0().s[11]++;throw new NotAllowedError(`user with id ${id} is deactivated`);}else{cov_1d182xqkg0().b[1][1]++;}cov_1d182xqkg0().s[12]++;if(!comment){cov_1d182xqkg0().b[2][0]++;cov_1d182xqkg0().s[13]++;throw new NotFoundError(`comment with id ${commentId} does not exist`);}else{cov_1d182xqkg0().b[2][1]++;}cov_1d182xqkg0().s[14]++;return Comment.findByIdAndUpdate(commentId,{$set:data});}).then(()=>{cov_1d182xqkg0().f[2]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZS1jb21tZW50LmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJDb21tZW50IiwiTm90QWxsb3dlZEVycm9yIiwiTm90Rm91bmRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCIsImNvbW1lbnRJZCIsImRhdGEiLCJzdHJpbmciLCJ0eXBlIiwiT2JqZWN0IiwiUHJvbWlzZSIsImFsbCIsImZpbmRCeUlkIiwidGhlbiIsInVzZXIiLCJjb21tZW50IiwiZGVhY3RpdmF0ZWQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRzZXQiXSwibWFwcGluZ3MiOiJ1eEZBQUEsS0FBTSxDQUFFQSxRQUFGLDJCQUFlQyxPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsT0FBUixDQUFWLDJCQUFnQ0gsT0FBTyxDQUFDLGdCQUFELENBQXZDLENBQU4sQ0FDQSxLQUFNLENBQUVJLGVBQUYsQ0FBbUJDLGFBQW5CLDJCQUFxQ0wsT0FBTyxDQUFDLGtCQUFELENBQTVDLENBQU4sQ0FFQTs7Ozs7Ozs7Ozs7MkJBYUFNLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxFQUFELENBQUtDLFNBQUwsQ0FBZ0JDLElBQWhCLEdBQXlCLGlEQUN0Q1gsUUFBUSxDQUFDWSxNQUFULENBQWdCSCxFQUFoQixDQUFvQixJQUFwQixFQURzQyx3QkFFdENULFFBQVEsQ0FBQ1ksTUFBVCxDQUFnQkYsU0FBaEIsQ0FBMkIsWUFBM0IsRUFGc0Msd0JBR3RDVixRQUFRLENBQUNhLElBQVQsQ0FBY0YsSUFBZCxDQUFvQixNQUFwQixDQUE0QkcsTUFBNUIsRUFIc0Msd0JBS3RDLE1BQU9DLENBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLENBQUNiLElBQUksQ0FBQ2MsUUFBTCxDQUFjUixFQUFkLENBQUQsQ0FBb0JMLE9BQU8sQ0FBQ2EsUUFBUixDQUFpQlAsU0FBakIsQ0FBcEIsQ0FBWixFQUNGUSxJQURFLENBQ0csQ0FBQyxDQUFDQyxJQUFELENBQU9DLE9BQVAsQ0FBRCxHQUFxQixpREFDdkIsR0FBSSxDQUFDRCxJQUFMLENBQVcseURBQU0sSUFBSWIsQ0FBQUEsYUFBSixDQUFtQixnQkFBZUcsRUFBRyxpQkFBckMsQ0FBTixDQUE0RCxDQUF2RSxpQ0FEdUIseUJBRXZCLEdBQUlVLElBQUksQ0FBQ0UsV0FBVCxDQUFzQiwwREFBTSxJQUFJaEIsQ0FBQUEsZUFBSixDQUFxQixnQkFBZUksRUFBRyxpQkFBdkMsQ0FBTixDQUE4RCxDQUFwRixpQ0FGdUIseUJBR3ZCLEdBQUksQ0FBQ1csT0FBTCxDQUFjLDBEQUFNLElBQUlkLENBQUFBLGFBQUosQ0FBbUIsbUJBQWtCSSxTQUFVLGlCQUEvQyxDQUFOLENBQXNFLENBQXBGLGlDQUh1Qix5QkFLdkIsTUFBT04sQ0FBQUEsT0FBTyxDQUFDa0IsaUJBQVIsQ0FBMEJaLFNBQTFCLENBQXFDLENBQUVhLElBQUksQ0FBRVosSUFBUixDQUFyQyxDQUFQLENBQ0gsQ0FQRSxFQVFGTyxJQVJFLENBUUcsSUFBTSx5QkFBRyxDQVJaLENBQVAsQ0FTSCxDQWREIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyB2YWxpZGF0ZSB9ID0gcmVxdWlyZSgncG9vcGluaW9uLXV0aWxzJylcclxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciwgQ29tbWVudCB9IH0gPSByZXF1aXJlKCdwb29waW5pb24tZGF0YScpXHJcbmNvbnN0IHsgTm90QWxsb3dlZEVycm9yLCBOb3RGb3VuZEVycm9yIH0gPSByZXF1aXJlKCdwb29waW5pb24tZXJyb3JzJylcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgY29tbWVudCBkYXRhXHJcbiAqIFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgdXNlcidzIHVuaXF1ZSBJRFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWVudElkIGNvbW1lbnQncyB1bmlxdWUgaWRcclxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgdGhlIGVsZW1lbnRzIHRoYXQgd2lsbCBiZSB1cGRhdGVkXHJcbiAqIFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSBhbiBlbXB0eSBQcm9taXNlIG9uIGEgc3VjY2Vzc2Z1bCB1cGRhdGVcclxuICogXHJcbiAqIEB0aHJvd3Mge05vdEFsbG93ZWRFcnJvcn0gaWYgYSB1c2VyIHNldCBhIHdyb25nIHBhc3N3b3JkIG9yIGlzIGRlYWN0aXZhdGVkXHJcbiAqIEB0aHJvd3Mge05vdEZvdW5kRXJyb3J9IGlmIHRoZSB1c2VyIG9yIHRoZSBjb21tZW50IGRvIG5vdCBleGlzdFxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gKGlkLCBjb21tZW50SWQsIGRhdGEpID0+IHtcclxuICAgIHZhbGlkYXRlLnN0cmluZyhpZCwgJ2lkJylcclxuICAgIHZhbGlkYXRlLnN0cmluZyhjb21tZW50SWQsICdjb21tZW50IElEJylcclxuICAgIHZhbGlkYXRlLnR5cGUoZGF0YSwgJ2RhdGEnLCBPYmplY3QpXHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtVc2VyLmZpbmRCeUlkKGlkKSwgQ29tbWVudC5maW5kQnlJZChjb21tZW50SWQpXSlcclxuICAgICAgICAudGhlbigoW3VzZXIsIGNvbW1lbnRdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYHVzZXIgd2l0aCBpZCAke2lkfSBkb2VzIG5vdCBleGlzdGApXHJcbiAgICAgICAgICAgIGlmICh1c2VyLmRlYWN0aXZhdGVkKSB0aHJvdyBuZXcgTm90QWxsb3dlZEVycm9yKGB1c2VyIHdpdGggaWQgJHtpZH0gaXMgZGVhY3RpdmF0ZWRgKVxyXG4gICAgICAgICAgICBpZiAoIWNvbW1lbnQpIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKGBjb21tZW50IHdpdGggaWQgJHtjb21tZW50SWR9IGRvZXMgbm90IGV4aXN0YClcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBDb21tZW50LmZpbmRCeUlkQW5kVXBkYXRlKGNvbW1lbnRJZCwgeyAkc2V0OiBkYXRhIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7IH0pXHJcbn0iXX0=