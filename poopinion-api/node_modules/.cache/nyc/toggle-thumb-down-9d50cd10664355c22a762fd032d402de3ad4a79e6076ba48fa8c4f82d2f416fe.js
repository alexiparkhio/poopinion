function cov_2aiw6jlgbr(){var path="C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\toggle-thumb-down.js";var hash="3926ecbfdf9fc77d9f6b0b71ae4186d662016c55";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Alex\\bootcamp\\collab\\skylab-bootcamp-202001\\staff\\alex-park\\poopinion\\poopinion-api\\logic\\toggle-thumb-down.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:47}},"1":{start:{line:2,column:38},end:{line:2,column:63}},"2":{start:{line:3,column:43},end:{line:3,column:70}},"3":{start:{line:17,column:0},end:{line:37,column:1}},"4":{start:{line:18,column:4},end:{line:18,column:29}},"5":{start:{line:19,column:4},end:{line:19,column:44}},"6":{start:{line:21,column:4},end:{line:36,column:24}},"7":{start:{line:23,column:12},end:{line:23,column:83}},"8":{start:{line:23,column:23},end:{line:23,column:83}},"9":{start:{line:24,column:12},end:{line:24,column:96}},"10":{start:{line:24,column:34},end:{line:24,column:96}},"11":{start:{line:25,column:12},end:{line:25,column:96}},"12":{start:{line:25,column:26},end:{line:25,column:96}},"13":{start:{line:27,column:12},end:{line:27,column:367}},"14":{start:{line:27,column:41},end:{line:27,column:367}},"15":{start:{line:29,column:12},end:{line:32,column:13}},"16":{start:{line:29,column:25},end:{line:29,column:26}},"17":{start:{line:30,column:26},end:{line:30,column:55}},"18":{start:{line:31,column:16},end:{line:31,column:270}},"19":{start:{line:31,column:39},end:{line:31,column:270}},"20":{start:{line:34,column:12},end:{line:34,column:338}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:17},end:{line:17,column:18}},loc:{start:{line:17,column:36},end:{line:37,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:14},end:{line:22,column:15}},loc:{start:{line:22,column:35},end:{line:35,column:9}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:357},end:{line:27,column:358}},loc:{start:{line:27,column:363},end:{line:27,column:366}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:31,column:260},end:{line:31,column:261}},loc:{start:{line:31,column:266},end:{line:31,column:269}},line:31},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:328},end:{line:34,column:329}},loc:{start:{line:34,column:334},end:{line:34,column:337}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:36,column:14},end:{line:36,column:15}},loc:{start:{line:36,column:20},end:{line:36,column:23}},line:36}},branchMap:{"0":{loc:{start:{line:23,column:12},end:{line:23,column:83}},type:"if",locations:[{start:{line:23,column:12},end:{line:23,column:83}},{start:{line:23,column:12},end:{line:23,column:83}}],line:23},"1":{loc:{start:{line:24,column:12},end:{line:24,column:96}},type:"if",locations:[{start:{line:24,column:12},end:{line:24,column:96}},{start:{line:24,column:12},end:{line:24,column:96}}],line:24},"2":{loc:{start:{line:25,column:12},end:{line:25,column:96}},type:"if",locations:[{start:{line:25,column:12},end:{line:25,column:96}},{start:{line:25,column:12},end:{line:25,column:96}}],line:25},"3":{loc:{start:{line:27,column:12},end:{line:27,column:367}},type:"if",locations:[{start:{line:27,column:12},end:{line:27,column:367}},{start:{line:27,column:12},end:{line:27,column:367}}],line:27},"4":{loc:{start:{line:31,column:16},end:{line:31,column:270}},type:"if",locations:[{start:{line:31,column:16},end:{line:31,column:270}},{start:{line:31,column:16},end:{line:31,column:270}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3926ecbfdf9fc77d9f6b0b71ae4186d662016c55"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2aiw6jlgbr=function(){return actualCoverage;};return actualCoverage;}cov_2aiw6jlgbr();const{validate}=(cov_2aiw6jlgbr().s[0]++,require('poopinion-utils'));const{models:{User,Comment}}=(cov_2aiw6jlgbr().s[1]++,require('poopinion-data'));const{NotAllowedError,NotFoundError}=(cov_2aiw6jlgbr().s[2]++,require('poopinion-errors'));/**
 * Adds or removes a thumb-down functionality to a target comment
 * 
 * @param {string} id user's unique id
 * @param {string} commentId comment's unique id
 * 
 * @returns {Promise<string>} returns an empty Promise on a successful thumb down
 * 
 * @throws {NotAllowedError} if the user exists but has the property 'deactivated' as true
 * @throws {NotFoundError} if the user or the comment do not exist
 */cov_2aiw6jlgbr().s[3]++;module.exports=(id,commentId)=>{cov_2aiw6jlgbr().f[0]++;cov_2aiw6jlgbr().s[4]++;validate.string(id,'id');cov_2aiw6jlgbr().s[5]++;validate.string(commentId,'comment ID');cov_2aiw6jlgbr().s[6]++;return Promise.all([User.findById(id).lean(),Comment.findById(commentId).lean()]).then(([user,comment])=>{cov_2aiw6jlgbr().f[1]++;cov_2aiw6jlgbr().s[7]++;if(!user){cov_2aiw6jlgbr().b[0][0]++;cov_2aiw6jlgbr().s[8]++;throw new NotFoundError(`user with id ${id} does not exist`);}else{cov_2aiw6jlgbr().b[0][1]++;}cov_2aiw6jlgbr().s[9]++;if(user.deactivated){cov_2aiw6jlgbr().b[1][0]++;cov_2aiw6jlgbr().s[10]++;throw new NotAllowedError(`user with id ${id} is deactivated`);}else{cov_2aiw6jlgbr().b[1][1]++;}cov_2aiw6jlgbr().s[11]++;if(!comment){cov_2aiw6jlgbr().b[2][0]++;cov_2aiw6jlgbr().s[12]++;throw new NotFoundError(`comment with id ${commentId} does not exist`);}else{cov_2aiw6jlgbr().b[2][1]++;}cov_2aiw6jlgbr().s[13]++;if(!user.thumbsDown.length){cov_2aiw6jlgbr().b[3][0]++;cov_2aiw6jlgbr().s[14]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$addToSet:{thumbsDown:comment._id.toString()},$pull:{thumbsUp:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$addToSet:{thumbsDown:user._id.toString()},$pull:{thumbsUp:user._id.toString()}})]).then(()=>{cov_2aiw6jlgbr().f[2]++;});}else{cov_2aiw6jlgbr().b[3][1]++;}cov_2aiw6jlgbr().s[15]++;for(let i=(cov_2aiw6jlgbr().s[16]++,0);i<user.thumbsDown.length;i++){let tUp=(cov_2aiw6jlgbr().s[17]++,user.thumbsDown[i].toString());cov_2aiw6jlgbr().s[18]++;if(tUp===commentId){cov_2aiw6jlgbr().b[4][0]++;cov_2aiw6jlgbr().s[19]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$pull:{thumbsDown:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$pull:{thumbsDown:user._id.toString()}})]).then(()=>{cov_2aiw6jlgbr().f[3]++;});}else{cov_2aiw6jlgbr().b[4][1]++;}}cov_2aiw6jlgbr().s[20]++;return Promise.all([User.findByIdAndUpdate(user._id.toString(),{$addToSet:{thumbsDown:comment._id.toString()},$pull:{thumbsUp:comment._id.toString()}}),Comment.findByIdAndUpdate(comment._id.toString(),{$addToSet:{thumbsDown:user._id.toString()},$pull:{thumbsUp:user._id.toString()}})]).then(()=>{cov_2aiw6jlgbr().f[4]++;});}).then(()=>{cov_2aiw6jlgbr().f[5]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvZ2dsZS10aHVtYi1kb3duLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJDb21tZW50IiwiTm90QWxsb3dlZEVycm9yIiwiTm90Rm91bmRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCIsImNvbW1lbnRJZCIsInN0cmluZyIsIlByb21pc2UiLCJhbGwiLCJmaW5kQnlJZCIsImxlYW4iLCJ0aGVuIiwidXNlciIsImNvbW1lbnQiLCJkZWFjdGl2YXRlZCIsInRodW1ic0Rvd24iLCJsZW5ndGgiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIl9pZCIsInRvU3RyaW5nIiwiJGFkZFRvU2V0IiwiJHB1bGwiLCJ0aHVtYnNVcCIsImkiLCJ0VXAiXSwibWFwcGluZ3MiOiIraElBQUEsS0FBTSxDQUFFQSxRQUFGLDJCQUFlQyxPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsT0FBUixDQUFWLDJCQUFnQ0gsT0FBTyxDQUFDLGdCQUFELENBQXZDLENBQU4sQ0FDQSxLQUFNLENBQUVJLGVBQUYsQ0FBbUJDLGFBQW5CLDJCQUFxQ0wsT0FBTyxDQUFDLGtCQUFELENBQTVDLENBQU4sQ0FFQTs7Ozs7Ozs7OzsyQkFZQU0sTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQUNDLEVBQUQsQ0FBS0MsU0FBTCxHQUFtQixpREFDaENWLFFBQVEsQ0FBQ1csTUFBVCxDQUFnQkYsRUFBaEIsQ0FBb0IsSUFBcEIsRUFEZ0Msd0JBRWhDVCxRQUFRLENBQUNXLE1BQVQsQ0FBZ0JELFNBQWhCLENBQTJCLFlBQTNCLEVBRmdDLHdCQUloQyxNQUFPRSxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxDQUFDVixJQUFJLENBQUNXLFFBQUwsQ0FBY0wsRUFBZCxFQUFrQk0sSUFBbEIsRUFBRCxDQUEyQlgsT0FBTyxDQUFDVSxRQUFSLENBQWlCSixTQUFqQixFQUE0QkssSUFBNUIsRUFBM0IsQ0FBWixFQUNGQyxJQURFLENBQ0csQ0FBQyxDQUFDQyxJQUFELENBQU9DLE9BQVAsQ0FBRCxHQUFxQixpREFDdkIsR0FBSSxDQUFDRCxJQUFMLENBQVcseURBQU0sSUFBSVgsQ0FBQUEsYUFBSixDQUFtQixnQkFBZUcsRUFBRyxpQkFBckMsQ0FBTixDQUE0RCxDQUF2RSxpQ0FEdUIsd0JBRXZCLEdBQUlRLElBQUksQ0FBQ0UsV0FBVCxDQUFzQiwwREFBTSxJQUFJZCxDQUFBQSxlQUFKLENBQXFCLGdCQUFlSSxFQUFHLGlCQUF2QyxDQUFOLENBQThELENBQXBGLGlDQUZ1Qix5QkFHdkIsR0FBSSxDQUFDUyxPQUFMLENBQWMsMERBQU0sSUFBSVosQ0FBQUEsYUFBSixDQUFtQixtQkFBa0JJLFNBQVUsaUJBQS9DLENBQU4sQ0FBc0UsQ0FBcEYsaUNBSHVCLHlCQUt2QixHQUFJLENBQUNPLElBQUksQ0FBQ0csVUFBTCxDQUFnQkMsTUFBckIsQ0FBNkIsMkRBQU9ULENBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLENBQUNWLElBQUksQ0FBQ21CLGlCQUFMLENBQXVCTCxJQUFJLENBQUNNLEdBQUwsQ0FBU0MsUUFBVCxFQUF2QixDQUE0QyxDQUFFQyxTQUFTLENBQUUsQ0FBRUwsVUFBVSxDQUFFRixPQUFPLENBQUNLLEdBQVIsQ0FBWUMsUUFBWixFQUFkLENBQWIsQ0FBcURFLEtBQUssQ0FBRSxDQUFFQyxRQUFRLENBQUVULE9BQU8sQ0FBQ0ssR0FBUixDQUFZQyxRQUFaLEVBQVosQ0FBNUQsQ0FBNUMsQ0FBRCxDQUFrSnBCLE9BQU8sQ0FBQ2tCLGlCQUFSLENBQTBCSixPQUFPLENBQUNLLEdBQVIsQ0FBWUMsUUFBWixFQUExQixDQUFrRCxDQUFFQyxTQUFTLENBQUUsQ0FBRUwsVUFBVSxDQUFFSCxJQUFJLENBQUNNLEdBQUwsQ0FBU0MsUUFBVCxFQUFkLENBQWIsQ0FBa0RFLEtBQUssQ0FBRSxDQUFFQyxRQUFRLENBQUVWLElBQUksQ0FBQ00sR0FBTCxDQUFTQyxRQUFULEVBQVosQ0FBekQsQ0FBbEQsQ0FBbEosQ0FBWixFQUFnVFIsSUFBaFQsQ0FBcVQsSUFBTSx5QkFBRyxDQUE5VCxDQUFQLENBQXNVLENBQW5XLGlDQUx1Qix5QkFPdkIsSUFBSyxHQUFJWSxDQUFBQSxDQUFDLDJCQUFHLENBQUgsQ0FBVixDQUFnQkEsQ0FBQyxDQUFHWCxJQUFJLENBQUNHLFVBQUwsQ0FBZ0JDLE1BQXBDLENBQTRDTyxDQUFDLEVBQTdDLENBQWlELENBQzdDLEdBQUlDLENBQUFBLEdBQUcsMkJBQUdaLElBQUksQ0FBQ0csVUFBTCxDQUFnQlEsQ0FBaEIsRUFBbUJKLFFBQW5CLEVBQUgsQ0FBUCxDQUQ2Qyx5QkFFN0MsR0FBSUssR0FBRyxHQUFLbkIsU0FBWixDQUF1QiwyREFBT0UsQ0FBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksQ0FBQ1YsSUFBSSxDQUFDbUIsaUJBQUwsQ0FBdUJMLElBQUksQ0FBQ00sR0FBTCxDQUFTQyxRQUFULEVBQXZCLENBQTRDLENBQUVFLEtBQUssQ0FBRSxDQUFFTixVQUFVLENBQUVGLE9BQU8sQ0FBQ0ssR0FBUixDQUFZQyxRQUFaLEVBQWQsQ0FBVCxDQUE1QyxDQUFELENBQWlHcEIsT0FBTyxDQUFDa0IsaUJBQVIsQ0FBMEJKLE9BQU8sQ0FBQ0ssR0FBUixDQUFZQyxRQUFaLEVBQTFCLENBQWtELENBQUVFLEtBQUssQ0FBRSxDQUFFTixVQUFVLENBQUVILElBQUksQ0FBQ00sR0FBTCxDQUFTQyxRQUFULEVBQWQsQ0FBVCxDQUFsRCxDQUFqRyxDQUFaLEVBQWlOUixJQUFqTixDQUFzTixJQUFNLHlCQUFHLENBQS9OLENBQVAsQ0FBdU8sQ0FBOVAsaUNBQ0gsQ0FWc0IseUJBWXZCLE1BQU9KLENBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLENBQUNWLElBQUksQ0FBQ21CLGlCQUFMLENBQXVCTCxJQUFJLENBQUNNLEdBQUwsQ0FBU0MsUUFBVCxFQUF2QixDQUE0QyxDQUFFQyxTQUFTLENBQUUsQ0FBRUwsVUFBVSxDQUFFRixPQUFPLENBQUNLLEdBQVIsQ0FBWUMsUUFBWixFQUFkLENBQWIsQ0FBcURFLEtBQUssQ0FBRSxDQUFFQyxRQUFRLENBQUVULE9BQU8sQ0FBQ0ssR0FBUixDQUFZQyxRQUFaLEVBQVosQ0FBNUQsQ0FBNUMsQ0FBRCxDQUFrSnBCLE9BQU8sQ0FBQ2tCLGlCQUFSLENBQTBCSixPQUFPLENBQUNLLEdBQVIsQ0FBWUMsUUFBWixFQUExQixDQUFrRCxDQUFFQyxTQUFTLENBQUUsQ0FBRUwsVUFBVSxDQUFFSCxJQUFJLENBQUNNLEdBQUwsQ0FBU0MsUUFBVCxFQUFkLENBQWIsQ0FBa0RFLEtBQUssQ0FBRSxDQUFFQyxRQUFRLENBQUVWLElBQUksQ0FBQ00sR0FBTCxDQUFTQyxRQUFULEVBQVosQ0FBekQsQ0FBbEQsQ0FBbEosQ0FBWixFQUFnVFIsSUFBaFQsQ0FBcVQsSUFBTSx5QkFBRyxDQUE5VCxDQUFQLENBQ0gsQ0FkRSxFQWVGQSxJQWZFLENBZUcsSUFBTSx5QkFBRyxDQWZaLENBQVAsQ0FnQkgsQ0FwQkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdwb29waW5pb24tdXRpbHMnKVxyXG5jb25zdCB7IG1vZGVsczogeyBVc2VyLCBDb21tZW50IH0gfSA9IHJlcXVpcmUoJ3Bvb3Bpbmlvbi1kYXRhJylcclxuY29uc3QgeyBOb3RBbGxvd2VkRXJyb3IsIE5vdEZvdW5kRXJyb3IgfSA9IHJlcXVpcmUoJ3Bvb3Bpbmlvbi1lcnJvcnMnKVxyXG5cclxuLyoqXHJcbiAqIEFkZHMgb3IgcmVtb3ZlcyBhIHRodW1iLWRvd24gZnVuY3Rpb25hbGl0eSB0byBhIHRhcmdldCBjb21tZW50XHJcbiAqIFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgdXNlcidzIHVuaXF1ZSBpZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWVudElkIGNvbW1lbnQncyB1bmlxdWUgaWRcclxuICogXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59IHJldHVybnMgYW4gZW1wdHkgUHJvbWlzZSBvbiBhIHN1Y2Nlc3NmdWwgdGh1bWIgZG93blxyXG4gKiBcclxuICogQHRocm93cyB7Tm90QWxsb3dlZEVycm9yfSBpZiB0aGUgdXNlciBleGlzdHMgYnV0IGhhcyB0aGUgcHJvcGVydHkgJ2RlYWN0aXZhdGVkJyBhcyB0cnVlXHJcbiAqIEB0aHJvd3Mge05vdEZvdW5kRXJyb3J9IGlmIHRoZSB1c2VyIG9yIHRoZSBjb21tZW50IGRvIG5vdCBleGlzdFxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gKGlkLCBjb21tZW50SWQpID0+IHtcclxuICAgIHZhbGlkYXRlLnN0cmluZyhpZCwgJ2lkJylcclxuICAgIHZhbGlkYXRlLnN0cmluZyhjb21tZW50SWQsICdjb21tZW50IElEJylcclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWQoaWQpLmxlYW4oKSwgQ29tbWVudC5maW5kQnlJZChjb21tZW50SWQpLmxlYW4oKV0pXHJcbiAgICAgICAgLnRoZW4oKFt1c2VyLCBjb21tZW50XSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKGB1c2VyIHdpdGggaWQgJHtpZH0gZG9lcyBub3QgZXhpc3RgKVxyXG4gICAgICAgICAgICBpZiAodXNlci5kZWFjdGl2YXRlZCkgdGhyb3cgbmV3IE5vdEFsbG93ZWRFcnJvcihgdXNlciB3aXRoIGlkICR7aWR9IGlzIGRlYWN0aXZhdGVkYClcclxuICAgICAgICAgICAgaWYgKCFjb21tZW50KSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgY29tbWVudCB3aXRoIGlkICR7Y29tbWVudElkfSBkb2VzIG5vdCBleGlzdGApXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIXVzZXIudGh1bWJzRG93bi5sZW5ndGgpIHJldHVybiBQcm9taXNlLmFsbChbVXNlci5maW5kQnlJZEFuZFVwZGF0ZSh1c2VyLl9pZC50b1N0cmluZygpLCB7ICRhZGRUb1NldDogeyB0aHVtYnNEb3duOiBjb21tZW50Ll9pZC50b1N0cmluZygpIH0sICRwdWxsOiB7IHRodW1ic1VwOiBjb21tZW50Ll9pZC50b1N0cmluZygpIH0gfSksIENvbW1lbnQuZmluZEJ5SWRBbmRVcGRhdGUoY29tbWVudC5faWQudG9TdHJpbmcoKSwgeyAkYWRkVG9TZXQ6IHsgdGh1bWJzRG93bjogdXNlci5faWQudG9TdHJpbmcoKSB9LCAkcHVsbDogeyB0aHVtYnNVcDogdXNlci5faWQudG9TdHJpbmcoKSB9IH0pXSkudGhlbigoKSA9PiB7IH0pXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVzZXIudGh1bWJzRG93bi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRVcCA9IHVzZXIudGh1bWJzRG93bltpXS50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICBpZiAodFVwID09PSBjb21tZW50SWQpIHJldHVybiBQcm9taXNlLmFsbChbVXNlci5maW5kQnlJZEFuZFVwZGF0ZSh1c2VyLl9pZC50b1N0cmluZygpLCB7ICRwdWxsOiB7IHRodW1ic0Rvd246IGNvbW1lbnQuX2lkLnRvU3RyaW5nKCkgfSB9KSwgQ29tbWVudC5maW5kQnlJZEFuZFVwZGF0ZShjb21tZW50Ll9pZC50b1N0cmluZygpLCB7ICRwdWxsOiB7IHRodW1ic0Rvd246IHVzZXIuX2lkLnRvU3RyaW5nKCkgfSB9KV0pLnRoZW4oKCkgPT4geyB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWRBbmRVcGRhdGUodXNlci5faWQudG9TdHJpbmcoKSwgeyAkYWRkVG9TZXQ6IHsgdGh1bWJzRG93bjogY29tbWVudC5faWQudG9TdHJpbmcoKSB9LCAkcHVsbDogeyB0aHVtYnNVcDogY29tbWVudC5faWQudG9TdHJpbmcoKSB9IH0pLCBDb21tZW50LmZpbmRCeUlkQW5kVXBkYXRlKGNvbW1lbnQuX2lkLnRvU3RyaW5nKCksIHsgJGFkZFRvU2V0OiB7IHRodW1ic0Rvd246IHVzZXIuX2lkLnRvU3RyaW5nKCkgfSwgJHB1bGw6IHsgdGh1bWJzVXA6IHVzZXIuX2lkLnRvU3RyaW5nKCkgfSB9KV0pLnRoZW4oKCkgPT4geyB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4geyB9KVxyXG59Il19